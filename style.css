* { box-sizing: border-box; font-family: 'Segoe UI', 'Arial', sans-serif; }

/* Theme variables */
.theme-gryffindor {
    --primary-bg: linear-gradient(135deg, #740001 0%, #D4AF37 100%);
    --secondary-bg: #740001;
    --accent: #D4AF37;
    --border-glow: #D4AF37;
    --button-shadow: #8B0000;
    --text-glow: #FFD700;
}
.theme-slytherin {
    --primary-bg: linear-gradient(135deg, #1A472A 0%, #AAAAAA 100%);
    --secondary-bg: #1A472A;
    --accent: #C0C0C0;
    --border-glow: #C0C0C0;
    --button-shadow: #0A2F1A;
    --text-glow: #E5E5E5;
}
.theme-ravenclaw {
    --primary-bg: linear-gradient(135deg, #0E2150 0%, #946B2D 100%);
    --secondary-bg: #0E2150;
    --accent: #CD7F32;
    --border-glow: #CD7F32;
    --button-shadow: #07122E;
    --text-glow: #FFB347;
}
.theme-hufflepuff {
    --primary-bg: linear-gradient(135deg, #ECB939 0%, #000000 100%);
    --secondary-bg: #ECB939;
    --accent: #FFD700;
    --border-glow: #FFD700;
    --button-shadow: #8B691F;
    --text-glow: #FFF;
}

body { 
    background: var(--primary-bg);
    display: flex; 
    justify-content: center; 
    align-items: center; 
    min-height: 100vh; 
    margin: 0;
    overflow: hidden;
}
.game-container { 
    text-align: center; 
    background: rgba(26, 26, 46, 0.9);
    backdrop-filter: blur(5px);
    padding: 25px; 
    border-radius: 30px; 
    box-shadow: 0 0 50px var(--border-glow), 0 0 100px rgba(212, 175, 55, 0.3);
    width: 800px; 
    border: 2px solid var(--border-glow);
    position: relative;
}
h1 { 
    color: var(--accent); 
    text-shadow: 0 0 10px var(--text-glow), 2px 2px 0 #000; 
    margin-bottom: 5px; 
    font-size: 42px; 
    font-family: 'Georgia', serif;
    letter-spacing: 2px;
}
#homeScreen, #gameScreen, #rankingsScreen, #resultScreen, #levelCompleteScreen, #gameOverScreen { display: none; }
#homeScreen { display: block; }
.selection-section { margin: 20px 0; }
.section-title { color: white; font-size: 24px; margin-bottom: 15px; text-shadow: 0 0 5px var(--border-glow); }
.house-btn, .char-btn { 
    padding: 12px 24px; 
    margin: 8px; 
    border: none; 
    color: white; 
    font-size: 18px; 
    border-radius: 40px; 
    cursor: pointer; 
    font-weight: bold; 
    width: 160px; 
    transition: all 0.2s;
    box-shadow: 0 4px 0 var(--button-shadow);
}
.house-btn:hover, .char-btn:hover { transform: scale(1.05); filter: brightness(1.2); }
.house-btn.selected, .char-btn.selected { 
    border: 4px solid var(--border-glow); 
    transform: scale(1.1);
    box-shadow: 0 0 20px var(--border-glow);
}
#startBtn { 
    background: var(--accent); 
    color: black; 
    padding: 18px 50px; 
    font-size: 28px; 
    border-radius: 60px; 
    cursor: pointer; 
    font-weight: bold; 
    margin-top: 30px; 
    border: none;
    box-shadow: 0 8px 0 var(--button-shadow);
    transition: 0.1s;
}
#startBtn:hover { transform: translateY(-2px); box-shadow: 0 10px 0 var(--button-shadow); }
#startBtn:active { transform: translateY(8px); box-shadow: 0 2px 0 var(--button-shadow); }
.info-panel { 
    color: white; 
    font-size: 22px; 
    margin: 10px 0; 
    background: rgba(22, 33, 62, 0.8);
    backdrop-filter: blur(4px);
    padding: 15px; 
    border-radius: 40px; 
    display: flex; 
    justify-content: space-around;
    border: 2px solid var(--border-glow);
}
canvas { 
    background: radial-gradient(circle at 20% 30%, #2a2a4a, #1a1a2e);
    border: 4px solid var(--border-glow); 
    border-radius: 20px; 
    display: block; 
    margin: 15px auto; 
    width: 500px; 
    height: 500px;
    box-shadow: 0 0 40px var(--border-glow);
}
.controls { margin-top: 10px; color: #ddd; font-size: 16px; }
button { 
    background: var(--accent); 
    color: black; 
    border: none; 
    padding: 10px 20px; 
    font-size: 18px; 
    border-radius: 30px; 
    cursor: pointer; 
    font-weight: bold; 
    margin: 5px;
    box-shadow: 0 4px 0 var(--button-shadow);
    transition: 0.1s;
}
button:hover { transform: translateY(-2px); box-shadow: 0 6px 0 var(--button-shadow); }
button:active { transform: translateY(4px); box-shadow: 0 2px 0 var(--button-shadow); }
#rankingsScreen h2, #resultScreen h2, #levelCompleteScreen h2, #gameOverScreen h2 { color: var(--accent); font-size: 36px; margin-bottom: 20px; text-shadow: 0 0 10px var(--text-glow); }
.rank-item, .result-item { 
    color: white; 
    font-size: 28px; 
    margin: 15px; 
    padding: 15px; 
    border-radius: 40px; 
    background: rgba(22, 33, 62, 0.9);
    border-left: 15px solid var(--accent);
    text-align: left;
    padding-left: 30px;
}
.result-box, .level-box, .gameover-box {
    background: rgba(22, 33, 62, 0.9);
    border: 3px solid var(--border-glow);
    border-radius: 40px;
    padding: 30px;
    margin: 20px;
    box-shadow: 0 0 40px var(--border-glow);
}
.result-box p, .level-box p, .gameover-box p {
    color: white;
    font-size: 24px;
    margin: 15px;
}
#timerBar {
    width: 100%;
    height: 20px;
    background: #333;
    border-radius: 10px;
    margin-top: 5px;
}
#timerFill {
    height: 100%;
    background: var(--accent);
    border-radius: 10px;
    width: 100%;
    transition: width 1s linear;
}
#tutorial {
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(0,0,0,0.7);
    color: white;
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1000;
}
.tutorial-box {
    background: #1a1a2e;
    border: 4px solid var(--border-glow);
    border-radius: 40px;
    padding: 30px;
    max-width: 500px;
    text-align: center;
}
.tutorial-box h2 { color: var(--accent); font-size: 32px; }
.tutorial-box p { font-size: 20px; margin: 20px; }
.floating-candle {
    position: absolute;
    width: 20px;
    height: 40px;
    background: linear-gradient(white, var(--accent));
    border-radius: 10px 10px 5px 5px;
    top: 10px;
    left: 10px;
    opacity: 0.6;
    animation: float 3s infinite;
}
@keyframes float { 0% { transform: translateY(0); } 50% { transform: translateY(-10px); } 100% { transform: translateY(0); } }